<div ng-show="example">
    <h1>{{answerName}}</h1>
    <p class="intro-text">This is one answer in the pair students will review as the first comparison for this assignment.</p>
</div>
<div ng-show="!example">
    <h1 ng-if="method == 'create'">Answer</h1>
    <h1 ng-if="method == 'edit'">Edit Answer</h1>
</div>

<p class="intro-text" ng-hide="comparison_example">Please note <strong>answers are not automatically saved</strong> as you type. However, you may manually save a draft of your answer below.</p>

<form class="form" name="answerForm" ng-submit="answerSubmit()" novalidate confirm-form-exit form-type="answer">
    <fieldset>
        <h2 ng-hide="comparison_example"><i class="fa fa-comments"></i> {{assignment.name}}</h2>
        <div class="assignment-desc" mathjax hljs ng-bind-html="assignment.description" ng-hide="comparison_example"></div>

        <!-- Attachment -->
        <compair-attachment-inline label="See assignment details:" attachment="assignment.file" ng-hide="comparison_example"></compair-attachment-inline>

        <hr ng-hide="comparison_example" />

        <div class="h3 text-center" ng-show="!canManageAssignment && showCountDown && comparison_example !== true">
            <timer end-time="assignment.answer_end">
                <span ng-show="minutes > 0 || seconds > 0" title="Official time remaining until deadline" class="bg-danger alert text-danger"><i class="glyphicon glyphicon-time"></i> {{minutes}} minutes {{seconds}} seconds left</span>
                <span ng-show="minutes == 0 && seconds == 0" class="bg-danger alert text-danger"><i class="glyphicon glyphicon-time"></i> DEADLINE REACHED</span>
            </timer>
            <br /><br />
            <span class="h4">(Answer must be submitted before deadline to be accepted)</span>
        </div>

        <div class="form-group" ng-if="canManageAssignment && answer.draft && comparison_example !== true">
            <label for="user_id">Submit As</label>
            <select id="user_id" name="user_id" required
                    ng-model="answer.user_id" class="form-control" chosen width="'100%'" disable_search_threshold="8"
                    ng-options="u.id as u.fullname for u in classlist">
            </select>
        </div>

        <div>
            <label for="importFile">Attachment (maximum size 25MB)</label>
            <p ng-hide="(uploader.queue.length) || (answer.file && answer.uploadedFile)">
                <span class="required-star"></span>
                <em>
                    Tip: Allowed file types include PDFs, MP3s, MP4s, JPGs, and PNGs.
                    Try downloading <a href="https://get.adobe.com/reader/">Acrobat Reader</a> or using <a href="https://www.mozilla.org/en-US/firefox/new/">Firefox</a> or <a href="http://www.google.com/chrome/">Chrome</a> if you have problems uploading PDFs.
                </em>
            </p>
            <input type="file" nv-file-select uploader="uploader" ng-click="answerForm.$setDirty()" id="importFile" ng-hide="(uploader.queue.length) || (answer.file && answer.uploadedFile)" multiple/>
            <p class="instructional-text" ng-show="uploader.queue.length"><strong>Save this answer</strong> to submit the file below. You may also remove the file and upload another instead.</p>
            <div class="row" ng-repeat="item in uploader.queue">
                <div class="col-md-7"><i class="fa fa-paperclip"></i> File: <strong>{{item.file.name}}</strong></div>
                <div class="col-md-1">{{item.file.size/1024/1024|number:2}} MB</div>
                <div class="col-md-2" ng-if="item.progress < 100"><strong>{{item.progress}}% uploaded</strong></div>
                <div class="col-md-2" ng-if="item.progress == 100 && !item.isSuccess"><strong>Storing file...</strong></div>
                <div class="col-md-2" ng-if="item.progress == 100 && item.isSuccess"><strong>Attached</strong></div>
                <div class="col-md-2">
                    <a class="btn btn-danger btn-xs" ng-click="item.cancel();item.remove();resetFileUploader();">
                        <i class="fa fa-trash-o"></i> Remove
                    </a>
                </div>
            </div>
        </div>
        <br>
        <div ng-show="answer.file && answer.uploadedFile">
            <div class="row">
                <div class="col-md-4">
                    <i class="fa fa-paperclip"></i> Attached File: <strong>{{answer.file.alias}}</strong>
                </div>
                <div class="col-md-1">
                    <a ng-click="deleteFile(answer.file)" class="btn btn-danger btn-xs">
                        <i class="fa fa-trash-o"></i> Remove
                    </a>
                </div>
            </div>
            <br>
        </div>
        <div class="form-group">
            <textarea ng-model="answer.content" id="answerContent"
                class="form-control" rows="8" ckeditor="editorOptions" ng-required="!(uploader.queue.length || uploadedFile || answer.file)">
            </textarea>
        </div>
	    <p ng-if="canManageAssignment" class="text-center">(Note: Answers submitted as an instructor/TA will not be included in comparisons and appear to students only after they answer/compare.)</p>
    </fieldset>
    <div class="text-center" ng-show="answer.draft && (!canManageAssignment || answer.user_id == loggedInUserId)">
        <input type="submit" class="btn btn-default btn-lg" value="Save Draft"
		    ng-click="answer.draft = true"
		    ng-disabled="answerForm.$invalid || submitted || (uploader.queue.length && !uploader.queue[0].isSuccess)" />
		&nbsp; &nbsp;
		<input type="submit" class="btn btn-success btn-lg" value="Submit"
            ng-click="answer.draft = false"
            ng-disabled="answerForm.$invalid || submitted || (uploader.queue.length && !uploader.queue[0].isSuccess)" />
    </div>
    <div ng-show="!answer.draft || (canManageAssignment && answer.user_id != loggedInUserId)">
        <input type="submit" class="btn btn-success btn-lg center-block" value="Save"
            ng-click="answer.draft = false"
            ng-disabled="answerForm.$invalid || submitted || (uploader.queue.length && !uploader.queue[0].isSuccess)" />
    </div>
</form>
